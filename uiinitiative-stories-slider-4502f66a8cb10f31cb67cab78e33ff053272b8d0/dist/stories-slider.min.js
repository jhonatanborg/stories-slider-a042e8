/**
 * UI Initiative Stories Slider 1.0.0
 *
 * Instagram-like Stories Slider Made With Swiper
 *
 * https://uiinitiative.com
 *
 * Copyright 2022-2022 UI Initiative
 *
 * Released under the UI Initiative Regular License
 *
 * Released on: July 22, 2022
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).createStoriesSlider=t()}(this,(function(){"use strict";return function(e,t={}){const i=e.querySelector(".swiper"),{autoplayDuration:s=5e3,Swiper:n,EffectCube:r,onSlidesIndexesChange:l,onAutoplayStart:o,onAutoplayStop:d}=t;let a,{enabled:c=!0}=t,p=0;const u=[];let m,v,f,h,b,g,y,E;const w=(e,t)=>{const i=u.indexOf(e);let n=void 0===t?s:t;const r=parseInt(e.slides[e.activeIndex].getAttribute("data-duration"),10);return!Number.isNaN(r)&&r>0&&void 0===t&&(n=r),y=n,e.storiesSliderAutoplayTimeout=setTimeout((()=>{if(e.isEnd){if(p!==i)return;a.isEnd||a.slideNext()}else e.slideNext()}),n),o&&o(e),n},x=e=>{clearTimeout(e.storiesSliderAutoplayTimeout),d&&d(e)},T=e=>{x(e);const t=y||s;let i=parseInt(e.slides[e.activeIndex].getAttribute("data-duration"),10);if(Number.isNaN(i)&&(i=void 0),y=t-((new Date).getTime()-g),e.isEnd&&y<0)return;y<0&&(y=0);const n=1-y/(i||s),r=e.$el.find(`.stories-slider-pagination-bullet:nth-child(${e.activeIndex+1})`);r.children("span").remove(),r.append(`<span style="transform:translateX(${100*n-100}%)"></span>`)},A=e=>{x(e),w(e),g=(new Date).getTime(),e.$el.find(".stories-slider-pagination-bullet-current").removeClass("stories-slider-pagination-bullet-current");const t=e.$el.find(`.stories-slider-pagination-bullet:nth-child(${e.activeIndex+1})`);t.prevAll().addClass("stories-slider-pagination-bullet-viewed").children("span").remove(),t.prevAll().append("<span></span>"),t.nextAll().removeClass("stories-slider-pagination-bullet-viewed stories-slider-pagination-bullet-current").children("span").remove(),t.nextAll().append("<span></span>"),t.removeClass("stories-slider-pagination-bullet-viewed").addClass("stories-slider-pagination-bullet-current").children("span").remove(),t.append("<span></span>"),t[0].clientWidth,t.children("span").transition(`${y}ms`).transform("translateX(0%)"),l&&(cancelAnimationFrame(m),m=requestAnimationFrame((()=>{l(p,e.activeIndex)})))};return(()=>{const t=()=>{e.classList.add("stories-slider-perspective")},s=()=>{e.classList.remove("stories-slider-perspective")};a=new n(i,{modules:void 0!==r?[r]:[],effect:"cube",speed:500,cubeEffect:{shadow:!1},observer:!0,on:{transitionStart(){s()},sliderFirstMove(){s()},transitionEnd(){t()},init(e){e.params.resistanceRatio=.5,t()},slideChange(){const e=u[p];p=a.activeIndex;const t=u[p];x(e),w(t),A(t)}}})})(),e.querySelectorAll(".swiper .swiper").forEach(((e,t)=>{const i=new n(e,{speed:1,nested:!0,allowTouchMove:!1,observer:!0,on:{touchStart(e){v=!0,E=!1,f=(new Date).getTime(),h=setTimeout((()=>{E=!0,T(e)}),200)},touchEnd(e){clearTimeout(h),p===t&&v&&(b=(new Date).getTime()-f,E&&(e=>{e.isEnd&&y<0||(g=(new Date).getTime(),w(e,y),e.$el.find(`.stories-slider-pagination-bullet:nth-child(${e.activeIndex+1})`).children("span").transform("translateX(0%)").transition(`${y}ms`))})(e),E=!1,v=!1)},init(e){c&&(p!==t?x(e):requestAnimationFrame((()=>{A(e)})))},slideChange(e){A(e)}}});(e=>{const t=e.querySelectorAll(".swiper-slide"),i=document.createElement("div");i.classList.add("stories-slider-pagination");for(let e=0;e<t.length;e+=1){const e=document.createElement("div");e.classList.add("stories-slider-pagination-bullet"),e.appendChild(document.createElement("span")),i.appendChild(e)}e.appendChild(i)})(e),((e,t)=>{e.querySelectorAll(".swiper-slide").forEach((e=>{const i=document.createElement("div"),s=document.createElement("div");i.classList.add("stories-slider-button","stories-slider-button-prev"),s.classList.add("stories-slider-button","stories-slider-button-next"),e.appendChild(i),e.appendChild(s),i.addEventListener("click",(()=>{b>200||(t.isBeginning?a.slidePrev():t.slidePrev())})),s.addEventListener("click",(()=>{b>200||(t.isEnd?a.slideNext():t.slideNext())}))}))})(e,i),u.push(i)})),{el:e,mainSwiper:a,subSwipers:u,destroy:()=>{a&&a.destroy&&a.destroy(),u.forEach((e=>{x(e),e.$el.find(".stories-slider-pagination, .stories-slider-pagination-bullet").remove(),(e=>{e.slides.find(".stories-slider-button").remove()})(e),e.destroy&&e.destroy()}))},slideTo:(e,t)=>{if(a&&a.slideTo&&!a.destroyed&&a.slideTo(e,0),void 0!==t){const i=u[e];i.slideTo&&!i.destroyed&&(i.activeIndex===t?A(i):i.slideTo(t,0))}},enable:()=>{c||u.forEach(((e,t)=>{t===p&&A(e)}))},disable:()=>{c=!1,u.forEach(((e,t)=>{t===p?T(e):x(e)}))}}}}));
//# sourceMappingURL=stories-slider.min.js.map